import{_ as t,u as e,s as a,a as s,n as l,a9 as n,K as i,D as c,V as o,o as d,e as r,w as u,i as f,f as _,j as g,t as m,C as p,k as h,l as k,F as b,m as x,q as $,v as y,x as C,y as I,Q as v}from"./index-2a18bb69.js";const N=e(a),w=s(a);const F=t({data:()=>({modelName:"",detail:{},userInfo:w.userInfo,globalConfig:w.globalConfig}),computed:{validatePhone(){return/^1[3456789]\d{9}$/.test(this.detail.account)}},onLoad(t){this.pop_notice=!1,this.$api.msgApi.getUserInfo({user_id:t.id}).then((t=>{0==t.code&&(this.detail=t.data)}))},methods:{sendMsg(t){l({url:"/pages/message/chat?id="+t.user_id})},sex(t){return[this.$t("contact.sex_nv"),this.$t("contact.sex_nan"),this.$t("contact.no_msg")][t]||this.$t("contact.no_msg")},callPhone(){let t=JSON.parse(JSON.stringify(w.userInfo));0!=t.islevel||1===t.role?n({phoneNumber:this.detail.account}):this.pop_notice=!0},calling(t){let e=JSON.parse(JSON.stringify(w.userInfo));if(0==t&&0==e.ifvoice&&1!==e.role)return void(this.pop_notice=!0);if(1==t&&0==e.ifvideo&&1!==e.role)return void(this.pop_notice=!0);if(N.webrtcLock)return i({title:this.$t("contact.other"),icon:"none"});this.modelName="";let a=this.$util.getUuid();l({url:"/pages/message/call?msg_id="+a+"&type="+t+"&status=1&id="+this.detail.user_id+"&name="+this.detail.realname+"&avatar="+encodeURI(this.detail.avatar)})},delFriend(){c({title:this.$t("contact.sure_del"),success:t=>{if(t.confirm){let t={id:this.detail.user_id};this.$api.friendApi.delFriend(t).then((e=>{0==e.code&&(N.deleteContacts(t),o({url:"/pages/index/index"}))}))}}})},addFriend(){c({title:this.$t("contact.check_msg"),editable:!0,success:t=>{if(t.confirm){if(""==t.content)return i({title:this.$t("contact.check_remark"),icon:"error"});this.$api.friendApi.addFriend({user_id:this.detail.user_id,remark:t.content}).then((t=>{0==t.code&&i({title:t.msg,icon:"none"})}))}}})},setNickname(){let t=this.detail.friend.friend_id??"";if(!this.detail.friend)return i({title:this.$t("contact.can_not_set"),icon:"error"});c({title:this.$t("contact.check_remark2"),editable:!0,success:e=>{if(e.confirm){if(""==e.content)return i({title:this.$t("contact.check_remark3"),icon:"error"});this.$api.friendApi.setNickname({friend_id:t,nickname:e.content}).then((t=>{0==t.code&&(this.detail.friend.nickname=e.content,i({title:t.msg,icon:"none"}))}))}}})}}},[["render",function(t,e,a,s,l,n){const i=C("cu-custom"),c=f,o=I,N=v;return d(),r(c,null,{default:u((()=>[_(i,{bgColor:"bg-gradual-pink",isBack:!0},{backText:u((()=>[])),content:u((()=>[g(m(t.$t("contact.title")),1)])),_:1}),_(c,{class:"padding flex justify-start align-center"},{default:u((()=>[_(c,{class:"cu-avatar lg radius mr-15",style:p("background-image:url("+l.detail.avatar+")")},null,8,["style"]),_(c,{class:"im-flex im-justify-content-start im-columns"},{default:u((()=>[_(c,{class:"mb-5"},{default:u((()=>[g(m(l.detail.realname),1)])),_:1}),_(c,{class:"text-gray"},{default:u((()=>[g(m(l.detail.account),1)])),_:1})])),_:1})])),_:1}),_(c,{class:"cu-list menu"},{default:u((()=>[2==l.globalConfig.sysInfo.runMode&&l.detail.friend&&l.userInfo.user_id!=l.detail.user_id?(d(),r(c,{key:0,class:"cu-item",onClick:n.setNickname},{default:u((()=>[_(c,{class:"content"},{default:u((()=>[_(o,{class:"cuIcon-edit text-green"}),_(o,null,{default:u((()=>[g(m(t.$t("contact.remarks")),1)])),_:1})])),_:1}),_(c,{class:"action"},{default:u((()=>[_(o,{class:"text-grey text-sm"},{default:u((()=>[g(m(l.detail.friend.nickname||t.$t("contact.no_set")),1)])),_:1}),_(o,{class:"text-grey text-sm ml-5 cuIcon-write"})])),_:1})])),_:1},8,["onClick"])):h("",!0),_(c,{class:"cu-item"},{default:u((()=>[_(c,{class:"content"},{default:u((()=>[_(o,{class:"cuIcon-safe text-green"}),_(o,null,{default:u((()=>[g(m(t.$t("contact.sex")),1)])),_:1})])),_:1}),_(c,{class:"action"},{default:u((()=>[_(o,{class:"text-grey text-sm"},{default:u((()=>[g(m(n.sex(l.detail.sex)),1)])),_:1})])),_:1})])),_:1}),parseInt(l.globalConfig.sysInfo.ipregion)?(d(),r(c,{key:1,class:"cu-item"},{default:u((()=>[_(c,{class:"content"},{default:u((()=>[_(o,{class:"cuIcon-location text-green"}),_(o,null,{default:u((()=>[g("IP")])),_:1})])),_:1}),_(c,{class:"action"},{default:u((()=>[l.detail.last_login_ip?(d(),r(o,{key:0,class:"text-grey text-sm"},{default:u((()=>[g(m(l.detail.last_login_ip||t.$t("contact.no_msg"))+" （"+m(l.detail.location||t.$t("contact.no_msg"))+"）",1)])),_:1})):(d(),r(o,{key:1,class:"text-grey text-sm"},{default:u((()=>[g("未知")])),_:1}))])),_:1})])),_:1})):h("",!0)])),_:1}),l.userInfo.user_id!=l.detail.user_id?(d(),k(b,{key:0},[1==l.globalConfig.sysInfo.runMode||l.detail.friend?(d(),r(c,{key:0,class:"padding flex flex-direction"},{default:u((()=>[_(N,{class:"cu-btn bg-green mt-10 lg",onClick:e[0]||(e[0]=t=>n.sendMsg(l.detail))},{default:u((()=>[g(m(t.$t("contact.send_msg")),1)])),_:1}),n.validatePhone?(d(),r(N,{key:0,class:"cu-btn bg-blue mt-10 lg",onClick:e[1]||(e[1]=t=>n.callPhone())},{default:u((()=>[g(m(t.$t("contact.call")),1)])),_:1})):h("",!0),parseInt(l.globalConfig.chatInfo.webrtc)?(d(),r(N,{key:1,class:"cu-btn bg-grey mt-10 lg",onClick:e[2]||(e[2]=t=>l.modelName="callRtc")},{default:u((()=>[g(m(t.$t("contact.video")),1)])),_:1})):h("",!0),2==l.globalConfig.sysInfo.runMode?(d(),r(N,{key:2,class:"cu-btn bg-red mt-10 lg",onClick:e[3]||(e[3]=t=>n.delFriend())},{default:u((()=>[g(m(t.$t("contact.del_friend")),1)])),_:1})):h("",!0)])),_:1})):h("",!0),2!=l.globalConfig.sysInfo.runMode||l.detail.friend?h("",!0):(d(),r(c,{key:1,class:"padding flex flex-direction"},{default:u((()=>[_(N,{class:"cu-btn bg-green lg",onClick:e[4]||(e[4]=t=>n.addFriend())},{default:u((()=>[g(m(t.$t("contact.add_friend")),1)])),_:1})])),_:1}))],64)):h("",!0),_(c,{class:x(["cu-modal bottom-modal","callRtc"==l.modelName?"show":""]),onClick:e[8]||(e[8]=t=>l.modelName="")},{default:u((()=>[_(c,{class:"cu-dialog"},{default:u((()=>[_(c,{class:"manage-content"},{default:u((()=>[_(c,{class:"cu-list menu bg-white"},{default:u((()=>[_(c,{class:"cu-item",onClick:e[5]||(e[5]=t=>n.calling(0))},{default:u((()=>[_(c,{class:"content padding-tb-sm"},{default:u((()=>[_(o,{class:"cuIcon-dianhua"}),_(o,null,{default:u((()=>[g(m(t.$t("contact.video_yuyin")),1)])),_:1})])),_:1})])),_:1}),_(c,{class:"cu-item",onClick:e[6]||(e[6]=t=>n.calling(1))},{default:u((()=>[_(c,{class:"content padding-tb-sm"},{default:u((()=>[_(o,{class:"cuIcon-record"}),_(o,null,{default:u((()=>[g(m(t.$t("contact.video_shiping")),1)])),_:1})])),_:1})])),_:1}),_(c,{class:"parting-line-5"}),_(c,{class:"cu-item",onClick:e[7]||(e[7]=t=>l.modelName="")},{default:u((()=>[_(c,{class:"content padding-tb-sm"},{default:u((()=>[_(o,{class:"c-red"},{default:u((()=>[g(m(t.$t("contact.close")),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["class"]),$(_(c,null,{default:u((()=>[_(c,{class:"com_bg"}),_(c,{class:"com_main"},{default:u((()=>[_(c,{class:"pop_mian"},{default:u((()=>[_(c,{class:"pop_title"},{default:u((()=>[g(m(t.$t("pop.title")),1)])),_:1}),_(c,{style:{padding:"10px 15px","line-height":"25px","flex-wrap":"wrap","text-align":"center"}},{default:u((()=>[g(m(t.$t("pop.content8")),1)])),_:1}),_(c,{class:"pop_foot"},{default:u((()=>[_(c,{class:"pop_ft_btn1",onClick:e[9]||(e[9]=e=>t.pop_notice=!1)},{default:u((()=>[g(m(t.$t("pop.close")),1)])),_:1}),_(c,{class:"pop_ft_btn2",onClick:e[10]||(e[10]=e=>t.pop_ok())},{default:u((()=>[g(m(t.$t("pop.up")),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},512),[[y,t.pop_notice]])])),_:1})}]]);export{F as default};
